---
title: Elementary OS 系统 sogoupinyin 问题
date: 2016-09-15 13:59
Author: neoyin
categories: 技术流
tags: ubuntu,elementary
permalink: elementary-os-sogoupinyin-bug
---

---

之前在`Elementary OS`上安装了sogou 拼音 安装软件时经常报错 很是烦人

```
下列软件包将被升级：
  sogoupinyin
升级了 1 个软件包，新安装了 0 个软件包，要卸载 0 个软件包，有 42 个软件包未被升级。
有 1 个软件包没有被完全安装或卸载。
需要下载 0 B/18.7 MB 的软件包。
解压缩后会消耗掉 307 kB 的额外空间。
您希望继续执行吗？ [Y/n] y
(正在读取数据库 ... 系统当前共安装有 358654 个文件和目录。)
正准备解包 .../sogoupinyin_2.0.0.0078_amd64.deb  ...
正在将 sogoupinyin (2.0.0.0078) 解包到 (2.0.0.0068) 上 ...
/var/lib/dpkg/info/sogoupinyin.postrm: 7: local: OS": bad variable name
dpkg：警告：子进程 旧的 post-removal 脚本 返回了错误号 2
dpkg: 现在尝试使用新软件包所带的脚本...
/var/lib/dpkg/tmp.ci/postrm: 7: local: OS": bad variable name
dpkg: 处理归档 /var/cache/apt/archives/sogoupinyin_2.0.0.0078_amd64.deb (--unpack)时出错：
 子进程 新的 post-removal 脚本 返回了错误号 2
/var/lib/dpkg/tmp.ci/postrm: 7: local: OS": bad variable name
dpkg：清理时出错:
 子进程 新的 post-removal 脚本 返回了错误号 2
正在处理用于 mime-support (3.54ubuntu1.1) 的触发器 ...
正在处理用于 bamfdaemon (0.5.1+14.04.20140409-0ubuntu1+elementary2~ubuntu14.04.1) 的触发器 ...
Rebuilding /usr/share/applications/bamf-2.index...
正在处理用于 gnome-menus (3.10.1-0ubuntu2) 的触发器 ...
正在处理用于 desktop-file-utils (0.22-1ubuntu1) 的触发器 ...
正在处理用于 shared-mime-info (1.2-0ubuntu3) 的触发器 ...
正在处理用于 hicolor-icon-theme (0.13-1) 的触发器 ...
正在处理用于 libglib2.0-0:amd64 (2.42.2-0ubuntu1~14.04~ricotz0) 的触发器 ...
dpkg: 处理归档 /var/cache/apt/archives/sogoupinyin_2.0.0.0078_amd64.deb (--unpack)时出错：
 子进程 新的 post-removal 脚本 返回了错误号 2
/var/lib/dpkg/tmp.ci/postrm: 7: local: OS": bad variable name
dpkg：清理时出错:
 子进程 新的 post-removal 脚本 返回了错误号 2
正在选中未选择的软件包 python-markupsafe。
正准备解包 .../python-markupsafe_0.18-1build2_amd64.deb  ...
正在解包 python-markupsafe (0.18-1build2) ...
正在选中未选择的软件包 python-jinja2。
正准备解包 .../python-jinja2_2.7.2-2_all.deb  ...
正在解包 python-jinja2 (2.7.2-2) ...
正在选中未选择的软件包 python-psutil。
正准备解包 .../python-psutil_1.2.1-1ubuntu2_amd64.deb  ...
正在解包 python-psutil (1.2.1-1ubuntu2) ...
正在选中未选择的软件包 glances。
正准备解包 .../glances_1.7.3-2ubuntu1_all.deb  ...
正在解包 glances (1.7.3-2ubuntu1) ...
正在处理用于 mime-support (3.54ubuntu1.1) 的触发器 ...
正在处理用于 bamfdaemon (0.5.1+14.04.20140409-0ubuntu1+elementary2~ubuntu14.04.1) 的触发器 ...
Rebuilding /usr/share/applications/bamf-2.index...
正在处理用于 gnome-menus (3.10.1-0ubuntu2) 的触发器 ...
正在处理用于 desktop-file-utils (0.22-1ubuntu1) 的触发器 ...
正在处理用于 shared-mime-info (1.2-0ubuntu3) 的触发器 ...
正在处理用于 hicolor-icon-theme (0.13-1) 的触发器 ...
正在处理用于 libglib2.0-0:amd64 (2.42.2-0ubuntu1~14.04~ricotz0) 的触发器 ...
覆盖文件 /usr/share/glib-2.0/schemas/50_sogoupinyin.gschema.override 中指定的方案 org.gnome.settings-daemon.plugins.xsettings 中没有键 Gtk/IMModule；忽略对此键的覆盖。
正在处理用于 ureadahead (0.100.0-16) 的触发器 ...
正在处理用于 man-db (2.6.7.1-1ubuntu1) 的触发器 ...
在处理时有错误发生：
 /var/cache/apt/archives/sogoupinyin_2.0.0.0078_amd64.deb
E: Sub-process /usr/bin/dpkg returned an error code (1)
```

网上找了一下原因是 搜狗没有对此系统做优化

###### 方案一
打开 `/var/lib/dpkg/info/sogoupinyin.postrm`
把第7行注释掉改成 `local RELEASE_ID=ubuntu`

###### 方案二
```
$ sudo sed -i.bak '3s/ OS/OS/g' /etc/os-release
$ sudo apt-get install sogoupinyin
$ sudo mv /etc/os-release.bak /etc/os-release
```

---

- <https://segmentfault.com/q/1010000002690503>




